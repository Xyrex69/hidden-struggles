<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Hidden Struggles</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="assets/logo.svg">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="nav-logo">
      <img src="assets/logo.svg" alt="Logo" class="logo">
      <span>The Hidden Struggles</span>
    </div>
    <ul class="nav-links">
      <li><a href="#home">Home</a></li>
      <li><a href="#story-map">Story Map</a></li>
      <li><a href="#action-corner">Action Corner</a></li>
      <li><a href="#journal-wall">Journal Wall</a></li>
      <li><a href="admin.html" id="admin-tab">Admin</a></li>
    </ul>
  </nav>

  <!-- Home Section -->
  <section id="home" class="section home-section">
    <div class="home-bg-pattern"></div>
    <h1>It costs nothing to ignore Indigenous mental health, but the consequences are real.</h1>
    <p class="intro">Welcome to The Hidden Struggles, a project dedicated to raising awareness about Indigenous mental health. Explore stories, take action, and share your voice anonymously.</p>
  </section>

  <!-- Story Map Section -->
  <section id="story-map" class="section">
    <h2>Story Map</h2>
    <div id="map" class="story-map"></div>
    <!-- Modal for full story -->
    <div id="story-modal" class="modal hidden">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h3 id="modal-title"></h3>
        <p id="modal-description"></p>
        <div id="modal-full-story"></div>
      </div>
    </div>
  </section>

  <!-- Action Corner Section -->
  <section id="action-corner" class="section action-corner">
    <h2>Action Corner</h2>
    <div class="action-cards">
      <div class="action-card">
        <h3>Petitions</h3>
        <ul>
          <li><a href="#" target="_blank">Petition 1</a></li>
          <li><a href="#" target="_blank">Petition 2</a></li>
          <li><a href="#" target="_blank">Petition 3</a></li>
        </ul>
      </div>
      <div class="action-card">
        <h3>Indigenous Spotify Playlists</h3>
        <!-- Placeholder for embedded playlist -->
        <div class="playlist-placeholder">[Spotify playlist embed here]</div>
      </div>
      <div class="action-card">
        <h3>How to Get Involved</h3>
        <ul>
          <li>Attend local Indigenous events</li>
          <li>Support Indigenous artists</li>
          <li>Share resources on social media</li>
        </ul>
      </div>
      <div class="action-card">
        <h3>Indigenous Artwork</h3>
        <div class="artwork-carousel">
          <button class="carousel-btn left">&#8592;</button>
          <div class="carousel-track">
          </div>
          <button class="carousel-btn right">&#8594;</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Journal Wall Section -->
  <section id="journal-wall" class="section journal-wall">
    <h2>Journal Wall</h2>
    <div class="moderation-note">Submissions are moderated before being displayed.</div>
    <form id="journal-form">
      <textarea name="text" id="journal-text" rows="3" placeholder="Share your thoughts anonymously..."></textarea><br>
      <select name="tag" id="journal-tag">
        <option value="">Select a tag (optional)</option>
        <option value="Hope">Hope</option>
        <option value="Struggle">Struggle</option>
        <option value="Healing">Healing</option>
        <option value="Pride">Pride</option>
      </select><br><br>
      <button type="submit">Submit</button>
    </form>
    <div id="journal-confirmation" class="confirmation hidden"><p>Thank you for sharing your thoughts. Your entry will be reviewed before being posted.</p></div>
    <div id="journal-entries" class="journal-entries"></div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-social">
        <!-- Placeholder social icons -->
        <span class="icon-placeholder">[FB]</span>
        <span class="icon-placeholder">[TW]</span>
        <span class="icon-placeholder">[IG]</span>
      </div>
      <div class="footer-contact">
        <span>Email: contact@hiddenstruggles.org</span>
      </div>
      <div class="footer-credit">
        &copy; 2025 The Hidden Struggles Project<br>
        With thanks to Indigenous youth and artists who inspire this work.
      </div>
    </div>
  </footer>

  <script src="script.js"></script>
  <script>
    async function loadPending() {
      const list = document.getElementById('pending-list');
      list.innerHTML = 'Loading...';
      try {
        const res = await fetch('/api/journal/pending');
        const entries = await res.json();
        if (!entries.length) {
          list.innerHTML = '<div>No pending entries.</div>';
          return;
        }
        list.innerHTML = '';
        entries.forEach(entry => {
          const card = document.createElement('div');
          card.className = 'pending-card';
          card.innerHTML = `<div><b>${entry.text}</b>${entry.tag ? `<span class='tag'>${entry.tag}</span>` : ''}</div><div style='margin-top:0.7rem;'><button class='approve'>Approve</button><button class='reject'>Reject</button></div>`;
          card.querySelector('.approve').onclick = async () => {
            await fetch(`/api/journal/${entry._id}/approve`, {method: 'PATCH'});
            loadPending();
          };
          card.querySelector('.reject').onclick = async () => {
            await fetch(`/api/journal/${entry._id}`, {method: 'DELETE'});
            loadPending();
          };
          list.appendChild(card);
        });
      } catch (err) {
        list.innerHTML = '<div style="color:#e53935;">Failed to load pending entries.</div>';
      }
    }
  </script>
</body>
</html> 